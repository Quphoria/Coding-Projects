e = 65537
n = 352758655756163603130656475864162239004344663459120398951306959672239055329877644796995008368282924624780849432051543118959312685532106237568240835778731486989439626252834661294225426875963944816709371554839452465119058016363040631618359944564550348310851045841670935254841385590882490443247265126417117450357
dp = 13530055667815347122266109008252377134325151556131892235929064596659462917644020624855537451062167377041847601387880412738836767351591511886432133011921729

c = 23428056833770750219439218340180501853506449797628734848807388355447212714387039203998085387476974936419607861041793755542930286287098871510394661091846780839592290953853536571372997807697657464569729651718518301857979495046280018444198435962234642736892075369840282923945267377104440625478468507147243879631

import gmpy2

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
        gcd = b
    return gcd, x, y

p = -1
q = -1

dpe = dp*e
for k in range(1,e+1):
    print(k)
    if n % (gmpy2.div(dpe - 1,k) + 1) == 0:
        print("Found!")
        p = gmpy2.div(dpe - 1,k) + 1
        q = gmpy2.div(n,gmpy2.div(dpe - 1,k) + 1)
        break
if p >= 0 and q >= 0:
    print("P: " + str(p))
    print("Q: " + str(q))
    print(p*q==n)
    phi = (p - 1) * (q - 1)
    gcd, a, b = egcd(e, phi)
    d = a
    txt = str(hex(pow(c, d, n)))[2:]
    message = ''.join([chr(int(''.join(c), 16)) for c in zip(txt[0::2],txt[1::2])])
    print("MSG: " + message)
